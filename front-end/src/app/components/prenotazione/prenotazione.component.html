<div
  class="d-flex justify-content-center text-primary align-items-center position-fixed z-3"
  *ngIf="caricamento"
  style="z-index: 1050; top: 50vh; left: 50vw; transform: translate(-50%, -50%)"
>
  <div class="spinner-border" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>

<!-- Spazio -->
<div class="container-fluid pt-4">
  <!-- Sezione partite del giorno -->
  <div class="container-fluid p-4 my-4">
    <div class="row bg-primary trasparenza">
      <div class="col-4 col-md">
        <div class="text-success">
          <h1>Scegli ora e giorno e prenota la tua prossima partita!</h1>
        </div>
      </div>
      <div class="col-1">
        <div class="card bg-primary">
          <input
            type="date"
            name="data"
            class="form-control w-50"
            (input)="onCambioData()"
            [(ngModel)]="dataSelezionata"
            [min]="mostraDaOggi()"
          />
        </div>
      </div>
    </div>
  </div>
  <div class="container mt-4 mb-4 text-center">
    <h2 *ngIf="dataOggi" class="text-primary mb-4">Disponibilità per oggi</h2>
    <h2 *ngIf="!dataOggi" class="text-primary mb-4">
      Disponibilità per il {{ formatattaData(dataSelezionata) }}
    </h2>
    <div class="container rounded-5">
      <div class="text-start mb-4 d-flex flex-wrap gap-2">
        <span
          style="width: 100px"
          (click)="scrollToCampo(campo.id!)"
          *ngFor="let campo of campiDisp"
          class="badge bg-primary text-success"
          >{{ campo.nomeCampo }}</span
        >
      </div>
      <div class="row g-3">
        <div
          class="col-12 justify-content-center d-flex disposizione"
          *ngFor="let campo of campiDisp"
        >
          <table
            [id]="campo.id"
            class="table table-striped table-borderless custom-table table border border-primary w-100"
          >
            <thead>
              <tr>
                <th class="fw-bold text-success bg-primary align-items-center">
                  <div class="d-flex flex-column justify-content-center">
                    <span>{{ campo.nomeCampo }}</span>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let slot of getNumMaxSlotsArray()">
                <td class="p-0">
                  <div
                    *ngIf="campo.slotOrari[slot.index]; else emptySlot"
                    class="h-100 w-100"
                  >
                    <div
                      (click)="
                        apriModale(
                          campo.slotOrari[slot.index].id!,
                          dataSelezionata,
                          campo.slotOrari[slot.index].inizio,
                          campo.slotOrari[slot.index].fine
                        )
                      "
                      [ngClass]="{
                        'disabled background border-bottom border-dark':
                          verificaBottoneDisabilitato(
                            campo.slotOrari[slot.index].inizio
                          ),
                        selezionati: isSlotSelected(
                          campo.slotOrari[slot.index]
                        ),
                        'position-relative': true,
                        'd-flex align-items-center justify-content-center h-100': true,
                        'rounded-bottom':
                          slot.index === getNumMaxSlotsArray().length - 1
                      }"
                      class="position-relative d-flex align-items-center justify-content-center h-100"
                    >
                      <span
                        *ngIf="
                          campo.slotOrari[slot.index] &&
                          !campo.slotOrari[slot.index].occupato
                        "
                        [ngClass]="{
                          'text-success': !verificaBottoneDisabilitato(
                            campo.slotOrari[slot.index].inizio
                          ),
                          'text-muted': verificaBottoneDisabilitato(
                            campo.slotOrari[slot.index].inizio
                          ),
                          'd-flex align-items-center justify-content-center': true
                        }"
                        class="d-flex align-items-center justify-content-center w-100"
                      >
                        {{ campo.slotOrari[slot.index].inizio | slice : 0 : 5 }}
                        -
                        {{ campo.slotOrari[slot.index].fine | slice : 0 : 5 }}
                      </span>
                      <span
                        *ngIf="
                          campo.slotOrari[slot.index] &&
                          campo.slotOrari[slot.index].occupato &&
                          campo.slotOrari[slot.index].motivoPrenotazione ==
                            'partita'
                        "
                        class="badge bg-primary text-success position-absolute"
                      >
                        occupato
                      </span>
                      <span
                        *ngIf="
                          campo.slotOrari[slot.index] &&
                          campo.slotOrari[slot.index].occupato &&
                          campo.slotOrari[slot.index].motivoPrenotazione !=
                            'partita'
                        "
                        class="badge bg-success text-primary position-absolute"
                      >
                        {{ campo.slotOrari[slot.index].motivoPrenotazione }}
                      </span>
                    </div>
                  </div>
                  <ng-template #emptySlot>
                    <div
                      class="text-muted background w-100 position-relative d-flex align-items-center justify-content-center h-100"
                    >
                      Non disponibile
                    </div>
                  </ng-template>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <div class="table-responsive-sm rounded-5">
      <table class="table table-striped table-borderless custom-table">
        <thead>
          <tr>
            <th
              scope="col"
              *ngFor="let campo of campiDisp"
              class="fw-bold text-success bg-primary align-items-center"
            >
              <div class="d-flex flex-column justify-content-center">
                <span>{{ campo.nomeCampo }}</span>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let slot of getNumMaxSlotsArray()">
            <td *ngFor="let campo of campiDisp" class="p-0">
              <div
                *ngIf="campo.slotOrari[slot.index]; else emptySlot"
                class="h-100 w-100"
              >
                <div
                  (click)="
                    apriModale(
                      campo.slotOrari[slot.index].id!,
                      dataSelezionata,
                      campo.slotOrari[slot.index].inizio,
                      campo.slotOrari[slot.index].fine
                    )
                  "
                  [ngClass]="{
                    'bg-dark': verificaBottoneDisabilitato(
                      campo.slotOrari[slot.index].inizio
                    ),

                    selezionati: isSlotSelected(campo.slotOrari[slot.index]),
                    'rounded-bottom-3': true,
                    'position-relative': true,
                    'd-flex align-items-center justify-content-center h-100': true
                  }"
                  class="rounded-bottom-3 position-relative d-flex align-items-center justify-content-center h-100"
                >
                  <span
                    *ngIf="
                      campo.slotOrari[slot.index] &&
                      !campo.slotOrari[slot.index].occupato
                    "
                    [ngClass]="{
                      'text-success': !verificaBottoneDisabilitato(
                        campo.slotOrari[slot.index].inizio
                      ),
                      'text-muted': verificaBottoneDisabilitato(
                        campo.slotOrari[slot.index].inizio
                      ),
                      'd-flex align-items-center justify-content-center': true
                    }"
                    class="d-flex align-items-center justify-content-center w-100"
                  >
                    {{ campo.slotOrari[slot.index].inizio | slice : 0 : 5 }} -
                    {{ campo.slotOrari[slot.index].fine | slice : 0 : 5 }}
                  </span>
                  <span
                    *ngIf="
                      campo.slotOrari[slot.index] &&
                      campo.slotOrari[slot.index].occupato &&
                      campo.slotOrari[slot.index].motivoPrenotazione ==
                        'partita'
                    "
                    class="badge bg-primary text-success position-absolute"
                  >
                    occupato
                  </span>
                  <span
                    *ngIf="
                      campo.slotOrari[slot.index] &&
                      campo.slotOrari[slot.index].occupato &&
                      campo.slotOrari[slot.index].motivoPrenotazione !=
                        'partita'
                    "
                    class="badge bg-success text-primary position-absolute"
                  >
                    {{ campo.slotOrari[slot.index].motivoPrenotazione }}
                  </span>
                </div>
              </div>
              <ng-template #emptySlot>
                <div
                  class="text-muted bg-dark w-100 position-relative d-flex align-items-center justify-content-center h-100"
                >
                  Non disponibile
                </div>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div> -->
